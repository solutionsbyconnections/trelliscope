<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="trelliscope">
<title>Introduction to Trelliscope • trelliscope</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to Trelliscope">
<meta property="og:description" content="trelliscope">
<meta property="og:image" content="https://trelliscope.github.io/trelliscope/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">trelliscope</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/trelliscope.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/trelliscope/trelliscope/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Introduction to Trelliscope</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/trelliscope/trelliscope/blob/HEAD/vignettes/trelliscope.Rmd" class="external-link"><code>vignettes/trelliscope.Rmd</code></a></small>
      <div class="d-none name"><code>trelliscope.Rmd</code></div>
    </div>

    
    
<p>Trelliscope provides a simple mechanism to make a collection of
visualizations and display them as interactive <a href="https://en.wikipedia.org/wiki/Small_multiple" class="external-link">small multiples</a>.
This is a useful general visualization technique for many scenarios,
particularly when looking at a somewhat large dataset comprised of many
natural subsets. However, where Trelliscope differentiates itself from
traditional faceting is in layout and interactivity. Traditionally,
facets appear in one large plot that becomes overwhelming with too many
groups. Trelliscope on the other hand allows you to generate a large
number of plots in an interactive window where the plots can be filtered
and sorted based on metadata and paged through with a limited number of
plots at a time.</p>
<p>The Trelliscope R package provides utilities to create the
visualizations, specify metadata about the visualizations that can be
used to interactively navigate them, and specify other aspects of how
the visualization viewer should behave. These specifications are given
to a Trelliscope viewer written in JavaScript.</p>
<div class="section level2">
<h2 id="data-frames-of-visualizations">Data frames of visualizations<a class="anchor" aria-label="anchor" href="#data-frames-of-visualizations"></a>
</h2>
<p>The basic principle behind the design of the R package is that you
specify a collection of visualizations as a data frame, with one column
representing the plot (either as a plot object such as ggplot or as a
reference to an image such as a png, svg, or even html file), and the
other columns representing metadata about each visualization.</p>
<p>This package provides utilities to help build these data frames and
then explore them in an interactive viewer.</p>
<div class="section level3">
<h3 id="pre-generated-images">Pre-generated images<a class="anchor" aria-label="anchor" href="#pre-generated-images"></a>
</h3>
<p>The simplest way to illustrate what we mean by a data frame of
visualizations is to start with an example where the images have already
been generated.</p>
<p>An example dataset that comes with the package contains images
captured by the Mars rover Curiosity.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://trelliscope.org/trelliscope" class="external-link">trelliscope</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">mars_rover</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1,245 × 5</span></span></span>
<span><span class="co">#&gt;    camera                  sol earth_date class   img_src                       </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                 <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> Mars Hand Lens Imager   565 2014-03-09 horizon http://mars.jpl.nasa.gov/msl-…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> Mars Hand Lens Imager   565 2014-03-09 horizon http://mars.jpl.nasa.gov/msl-…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> Mars Hand Lens Imager   568 2014-03-12 wheel   http://mars.jpl.nasa.gov/msl-…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> Mars Hand Lens Imager   568 2014-03-12 wheel   http://mars.jpl.nasa.gov/msl-…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> Mars Hand Lens Imager   568 2014-03-12 wheel   http://mars.jpl.nasa.gov/msl-…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> Mars Hand Lens Imager   568 2014-03-12 wheel   http://mars.jpl.nasa.gov/msl-…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> Mars Hand Lens Imager   568 2014-03-12 wheel   http://mars.jpl.nasa.gov/msl-…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> Mars Hand Lens Imager   568 2014-03-12 wheel   http://mars.jpl.nasa.gov/msl-…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> Mars Hand Lens Imager   568 2014-03-12 wheel   http://mars.jpl.nasa.gov/msl-…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> Mars Hand Lens Imager   568 2014-03-12 wheel   http://mars.jpl.nasa.gov/msl-…</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1,235 more rows</span></span></span></code></pre></div>
<p>This data frame has a column that references images on the web. The
other columns contain metadata about these images. We can create a
Trelliscope data frame with this data frame with the following:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/as_trelliscope_df.html">as_trelliscope_df</a></span><span class="op">(</span><span class="va">mars_rover</span>, name <span class="op">=</span> <span class="st">"mars rover"</span>, path <span class="op">=</span> <span class="st">"mars"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Using <span style="color: #00BB00;">img_src</span> as image column</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Using the variables <span style="color: #0000BB;">"camera"</span>, <span style="color: #0000BB;">"earth_date"</span>, <span style="color: #0000BB;">"class"</span>, and <span style="color: #0000BB;">"img_src"</span> to</span></span>
<span><span class="co">#&gt;   uniquely identify each row of the data.</span></span>
<span><span class="co">#&gt; Warning: <span style="color: #BBBB00;">!</span> Trelliscope shoud only be rendered in RMarkdown when self_contained is false.</span></span>
<span><span class="co">#&gt;   Trelliscope always produces auxiliary files</span></span>
<span></span>
<span><span class="va">d</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Trelliscope data frame. Call show_info() for more information</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1,245 × 5</span></span></span>
<span><span class="co">#&gt;    camera                  sol earth_date class   `__PANEL_KEY__`               </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                 <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;charactr&gt;</span>                    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> Mars Hand Lens Imager   565 2014-03-09 horizon http://mars.jpl.nasa.gov/msl-…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> Mars Hand Lens Imager   565 2014-03-09 horizon http://mars.jpl.nasa.gov/msl-…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> Mars Hand Lens Imager   568 2014-03-12 wheel   http://mars.jpl.nasa.gov/msl-…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> Mars Hand Lens Imager   568 2014-03-12 wheel   http://mars.jpl.nasa.gov/msl-…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> Mars Hand Lens Imager   568 2014-03-12 wheel   http://mars.jpl.nasa.gov/msl-…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> Mars Hand Lens Imager   568 2014-03-12 wheel   http://mars.jpl.nasa.gov/msl-…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> Mars Hand Lens Imager   568 2014-03-12 wheel   http://mars.jpl.nasa.gov/msl-…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> Mars Hand Lens Imager   568 2014-03-12 wheel   http://mars.jpl.nasa.gov/msl-…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> Mars Hand Lens Imager   568 2014-03-12 wheel   http://mars.jpl.nasa.gov/msl-…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> Mars Hand Lens Imager   568 2014-03-12 wheel   http://mars.jpl.nasa.gov/msl-…</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1,235 more rows</span></span></span></code></pre></div>
<p>This is simply the same data frame but with additional information
for how to render the Trelliscope viewer app. At a minimum we provide a
name for the resulting display and a path to where we want the output to
be written, but we can also specify additional information such as a
descriptions and tags. You can also specify the <code>key_cols</code>
which are the columns that combined, uniquely identify each row of the
data. This is inferred if not provided but sometimes might not be what
you would like it to be, as there often are many possibilities.</p>
<p>To see more information about trelliscope-specific settings, you can
use <code><a href="../reference/show_info.html">show_info()</a></code>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/show_info.html">show_info</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span></span>
<span><span class="co">#&gt; A trelliscope display</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> <span style="font-weight: bold;">Name</span>: <span style="color: #0000BB;">"mars rover"</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> <span style="font-weight: bold;">Description</span>: <span style="color: #0000BB;">"mars rover"</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> <span style="font-weight: bold;">Tags</span>: <span style="font-style: italic;">none</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> <span style="font-weight: bold;">Key columns</span>: <span style="color: #0000BB;">"camera"</span>, <span style="color: #0000BB;">"earth_date"</span>, <span style="color: #0000BB;">"class"</span>, and <span style="color: #0000BB;">"img_src"</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> <span style="font-weight: bold;">Path</span>: <span style="color: #9E9E9E;">"mars"</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> <span style="font-weight: bold;">Number of panels</span>: <span style="color: #0000BB;">1245</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> <span style="font-weight: bold;">Panels written</span>: <span style="font-style: italic;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> Metadata variables that will be inferred:</span></span>
<span><span class="co">#&gt; <span style="color: #9E9E9E;">    ─────────────────────────────────</span></span></span>
<span><span class="co">#&gt; <span style="color: #9E9E9E;">    name       `inferred type` label </span></span></span>
<span><span class="co">#&gt; <span style="color: #9E9E9E;">    ─────────────────────────────────</span></span></span>
<span><span class="co">#&gt; <span style="color: #9E9E9E;">    </span><span style="color: #BCBCBC;">1</span><span style="color: #9E9E9E;"> camera     string          [none]</span></span></span>
<span><span class="co">#&gt; <span style="color: #9E9E9E;">    </span><span style="color: #BCBCBC;">2</span><span style="color: #9E9E9E;"> sol        number          [none]</span></span></span>
<span><span class="co">#&gt; <span style="color: #9E9E9E;">    </span><span style="color: #BCBCBC;">3</span><span style="color: #9E9E9E;"> earth_date string          [none]</span></span></span>
<span><span class="co">#&gt; <span style="color: #9E9E9E;">    </span><span style="color: #BCBCBC;">4</span><span style="color: #9E9E9E;"> class      string          [none]</span></span></span>
<span><span class="co">#&gt; <span style="color: #9E9E9E;">    ─────────────────────────────────</span></span></span></code></pre></div>
<p>Now to view this in the Trelliscope viewer app:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/view_trelliscope.html">view_trelliscope</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Display has not been written... writing...</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Meta definitions inferred for variables <span style="color: #0000BB;">"camera"</span>, <span style="color: #0000BB;">"sol"</span>, <span style="color: #0000BB;">"earth_date"</span>, and</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">"class"</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> No default <span style="color: #0000BB;">"layout"</span> state supplied. <span style="font-style: italic;">Using ncol=3.</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> No default <span style="color: #0000BB;">"labels"</span> state supplied. <span style="font-style: italic;">Using camera, earth_date, class, img_src.</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Trelliscope written to mars/index.html Open this file or call</span></span>
<span><span class="co">#&gt;   view_trelliscope() to view.</span></span></code></pre></div>
<p>You can use this viewer to interactively explore the images.</p>
<p>There are many customization options that will be covered throughout
this document.</p>
</div>
<div class="section level3">
<h3 id="r-generated-visualizations">R-generated visualizations<a class="anchor" aria-label="anchor" href="#r-generated-visualizations"></a>
</h3>
<p>A likely more common use case when visualizing data during an
analysis will be that the images do not yet exist and we will be
creating them from subsets of the data we are analyzing. Trelliscope has
utilities to make this convenient for packages like ggplot2.</p>
<p>As a simple example, let’s consider the <code>gapminder</code>
dataset that originally comes with the <a href="https://cran.r-project.org/web/packages/gapminder/index.html" class="external-link"><code>gapminder</code></a>
package. For convenience, we have included a modified version of the
dataset with the Trelliscope package.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gapminder</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1,476 × 9</span></span></span>
<span><span class="co">#&gt;    country   continent  year lifeExp    pop gdpPercap capital latitude longitude</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> Afghanis… Asia       <span style="text-decoration: underline;">1</span>952    28.8 8.43<span style="color: #949494;">e</span>6      779. Kabul       34.5      69.2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> Afghanis… Asia       <span style="text-decoration: underline;">1</span>957    30.3 9.24<span style="color: #949494;">e</span>6      821. Kabul       34.5      69.2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> Afghanis… Asia       <span style="text-decoration: underline;">1</span>962    32.0 1.03<span style="color: #949494;">e</span>7      853. Kabul       34.5      69.2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> Afghanis… Asia       <span style="text-decoration: underline;">1</span>967    34.0 1.15<span style="color: #949494;">e</span>7      836. Kabul       34.5      69.2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> Afghanis… Asia       <span style="text-decoration: underline;">1</span>972    36.1 1.31<span style="color: #949494;">e</span>7      740. Kabul       34.5      69.2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> Afghanis… Asia       <span style="text-decoration: underline;">1</span>977    38.4 1.49<span style="color: #949494;">e</span>7      786. Kabul       34.5      69.2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> Afghanis… Asia       <span style="text-decoration: underline;">1</span>982    39.9 1.29<span style="color: #949494;">e</span>7      978. Kabul       34.5      69.2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> Afghanis… Asia       <span style="text-decoration: underline;">1</span>987    40.8 1.39<span style="color: #949494;">e</span>7      852. Kabul       34.5      69.2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> Afghanis… Asia       <span style="text-decoration: underline;">1</span>992    41.7 1.63<span style="color: #949494;">e</span>7      649. Kabul       34.5      69.2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> Afghanis… Asia       <span style="text-decoration: underline;">1</span>997    41.8 2.22<span style="color: #949494;">e</span>7      635. Kabul       34.5      69.2</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1,466 more rows</span></span></span></code></pre></div>
<p>This data provides statistics such as life expectancy annually for
123 countries.</p>
<p>Suppose we want to visualize life expectancy vs. year for each
country. With ggplot2, you would do something like this:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://trelliscope.org/trelliscope" class="external-link">trelliscope</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">gapminder</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">year</span>, <span class="va">lifeExp</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">country</span>, <span class="va">continent</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>There are too many panels to view on one page, making this a good
candidate for Trelliscope.</p>
<p>Trelliscope provides a function <code><a href="../reference/facet_panels.html">facet_panels()</a></code> that is
the first step in turning a ggplot object into a Trelliscope data frame.
You can swap out <code><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap()</a></code> for this function.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">gapminder</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">year</span>, <span class="va">lifeExp</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/facet_panels.html">facet_panels</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">country</span>, <span class="va">continent</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "facet_panels" "gg"           "ggplot"</span></span></code></pre></div>
<p>As you can see, <code><a href="../reference/facet_panels.html">facet_panels()</a></code> simply modifies your
ggplot object. If you print the resulting object <code>p</code>, a
Trelliscope display will be written and displayed. To take this and turn
it into a data frame of visualizations with one row for each
country/continent, we can apply the function
<code><a href="../reference/nest_panels.html">nest_panels()</a></code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p_nested</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nest_panels.html">nest_panels</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p_nested</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 123 × 4</span></span></span>
<span><span class="co">#&gt;    country     continent data              panel     </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;nstd_pnl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> Afghanistan Asia      <span style="color: #949494;">&lt;tibble [12 × 8]&gt;</span> <span style="color: #949494;">&lt;gg&gt;</span>      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> Albania     Europe    <span style="color: #949494;">&lt;tibble [12 × 8]&gt;</span> <span style="color: #949494;">&lt;gg&gt;</span>      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> Algeria     Africa    <span style="color: #949494;">&lt;tibble [12 × 8]&gt;</span> <span style="color: #949494;">&lt;gg&gt;</span>      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> Angola      Africa    <span style="color: #949494;">&lt;tibble [12 × 8]&gt;</span> <span style="color: #949494;">&lt;gg&gt;</span>      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> Argentina   Americas  <span style="color: #949494;">&lt;tibble [12 × 8]&gt;</span> <span style="color: #949494;">&lt;gg&gt;</span>      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> Australia   Oceania   <span style="color: #949494;">&lt;tibble [12 × 8]&gt;</span> <span style="color: #949494;">&lt;gg&gt;</span>      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> Austria     Europe    <span style="color: #949494;">&lt;tibble [12 × 8]&gt;</span> <span style="color: #949494;">&lt;gg&gt;</span>      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> Bahrain     Asia      <span style="color: #949494;">&lt;tibble [12 × 8]&gt;</span> <span style="color: #949494;">&lt;gg&gt;</span>      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> Bangladesh  Asia      <span style="color: #949494;">&lt;tibble [12 × 8]&gt;</span> <span style="color: #949494;">&lt;gg&gt;</span>      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> Belgium     Europe    <span style="color: #949494;">&lt;tibble [12 × 8]&gt;</span> <span style="color: #949494;">&lt;gg&gt;</span>      </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 113 more rows</span></span></span></code></pre></div>
<p>Here, just as in the Mars rover example, we have a data frame of
visualizations. However, in this case, the visualizations are ggplot
objects instead of image references.</p>
<p>Note that <code><a href="../reference/nest_panels.html">nest_panels()</a></code> has options such as
<code>as_plotly = TRUE</code> that will convert the ggplot objects to
plotly objects.</p>
<p>You can view the plot for any one row by calling the panel column and
the index number of the row you want to look at. For example, if you
wanted to see the generated plot for the second row, Albania, you would
run the following code.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p_nested</span><span class="op">$</span><span class="va">panel</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<p><img src="trelliscope_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<p>Note that this nested data frame of visualizations can be a useful
object to work with outside of using it with Trelliscope.</p>
<p>Just as in the Mars rover example, we can view this data frame of
visualizations and cast it as a Trelliscope data frame with
<code>as_trelliscoe_df()</code> and view it with
<code><a href="../reference/view_trelliscope.html">view_trelliscope()</a></code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">trell_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/as_trelliscope_df.html">as_trelliscope_df</a></span><span class="op">(</span><span class="va">p_nested</span>,</span>
<span>  name <span class="op">=</span> <span class="st">"gapminder life expectancy"</span>, path <span class="op">=</span> <span class="st">"lifeexp"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: <span style="color: #BBBB00;">!</span> Trelliscope shoud only be rendered in RMarkdown when self_contained is false.</span></span>
<span><span class="co">#&gt;   Trelliscope always produces auxiliary files</span></span>
<span></span>
<span><span class="fu"><a href="../reference/view_trelliscope.html">view_trelliscope</a></span><span class="op">(</span><span class="va">trell_df</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Display has not been written... writing...</span></span>
<span><span class="co">#&gt; Writing panels <span style="color: #00BB00;">■■■                             </span>   7% | ETA: 13s</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Writing panels <span style="color: #00BB00;">■■■■■■■■                        </span>  23% | ETA: 11s</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Writing panels <span style="color: #00BB00;">■■■■■■■■■■■■■                   </span>  41% | ETA:  9s</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Writing panels <span style="color: #00BB00;">■■■■■■■■■■■■■■■■■■■             </span>  61% | ETA:  6s</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Writing panels <span style="color: #00BB00;">■■■■■■■■■■■■■■■■■■■■■■■■■       </span>  81% | ETA:  3s</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Writing panels <span style="color: #00BB00;">■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■ </span> 100% | ETA:  0s</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Meta definitions inferred for variables <span style="color: #0000BB;">"country"</span> and <span style="color: #0000BB;">"continent"</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> No default <span style="color: #0000BB;">"layout"</span> state supplied. <span style="font-style: italic;">Using ncol=3.</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> No default <span style="color: #0000BB;">"labels"</span> state supplied. <span style="font-style: italic;">Using country, continent.</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Trelliscope written to lifeexp/index.html Open this file or call</span></span>
<span><span class="co">#&gt;   view_trelliscope() to view.</span></span></code></pre></div>
<p>The remainder of this tutorial will cover customizations that you can
apply to Trelliscope data frames to provide more powerful interactions
when viewing them in the app.</p>
<p>Note that there are several benefits to using
<code><a href="../reference/facet_panels.html">facet_panels()</a></code> and <code><a href="../reference/nest_panels.html">nest_panels()</a></code>. First, it
fits more naturally into the ggplot2 paradigm, where you can build a
Trelliscope visualization exactly as you would with building a ggplot2
visualization. Second, you can make use of the <code>scales</code>
argument in <code><a href="../reference/facet_panels.html">facet_panels()</a></code> (which behaves similarly to the
same argument in <code><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap()</a></code>) to ensure that the x and y
axis ranges of your plots behave the way you want. The default is for
all plots to have the same <code>"fixed"</code> axis ranges. This is an
important consideration in visualizing small multiples because if you
are making visual comparisons you often want to be comparing things on
the same scale.</p>
</div>
</div>
<div class="section level2">
<h2 id="customizing-your-trelliscope-app">Customizing your Trelliscope app<a class="anchor" aria-label="anchor" href="#customizing-your-trelliscope-app"></a>
</h2>
<p>So far we have seen a few ways to get to a Trelliscope data frame
that we can use to create a Trelliscope interactive visualization app.
As we’ve seen, you can simply pass a Trelliscope data frame to
<code><a href="../reference/view_trelliscope.html">view_trelliscope()</a></code> to get to an immediate output. However,
there are many other operations you can perform on a Trelliscope data
frame that customize how the app behaves.</p>
<div class="section level3">
<h3 id="pipe-functions">Pipe functions<a class="anchor" aria-label="anchor" href="#pipe-functions"></a>
</h3>
<p>A Trelliscope data frame is simply a data frame with attributes about
the Trelliscope display that we can modify with <a href="https://r4ds.had.co.nz/pipes.html" class="external-link">pipe functions</a> (functions
that take a Trelliscope data frame as its primary argument and return a
modified Trelliscope data frame).</p>
<p>The following pipe functions are available for modifying a
Trelliscope data frame.</p>
<ul>
<li>Setting the default viewing state of the app
<ul>
<li><code><a href="../reference/set_default_filters.html">set_default_filters()</a></code></li>
<li><code><a href="../reference/set_default_labels.html">set_default_labels()</a></code></li>
<li><code><a href="../reference/set_default_layout.html">set_default_layout()</a></code></li>
<li><code><a href="../reference/set_default_sort.html">set_default_sort()</a></code></li>
</ul>
</li>
<li>Fine-tune how metadata is handled in the app
<ul>
<li>
<code><a href="../reference/add_meta_defs.html">add_meta_defs()</a></code>
<!-- : specify metadata variable definitions (e.g. plain text variable descriptions, types, tags) -->
<!-- - `add_meta_def()` -->
</li>
<li>
<code><a href="../reference/add_meta_labels.html">add_meta_labels()</a></code>
<!-- : an alternative to fully specifying metadata variable definitions, this is a convenience function to only supply labels for all of the variables -->
</li>
<li><code><a href="../reference/add_meta_tags.html">add_meta_tags()</a></code></li>
</ul>
</li>
<li>Miscellaneous
<ul>
<li><code><a href="../reference/add_inputs.html">add_inputs()</a></code></li>
<li>
<code><a href="../reference/add_view.html">add_view()</a></code>
<!-- : add a pre-defined "view" that navigates the user to specified states of the display -->
</li>
<li>
<code><a href="../reference/add_charm.html">add_charm()</a></code>
<!-- : simple password protection for the generated app -->
</li>
</ul>
</li>
<li>Writing and viewing
<ul>
<li>
<code><a href="../reference/write_panels.html">write_panels()</a></code>
<!-- : finer control over how panels are written (e.g. plot dimensions, file format, etc.) -->
</li>
<li><code><a href="../reference/write_trelliscope.html">write_trelliscope()</a></code></li>
<li><code><a href="../reference/view_trelliscope.html">view_trelliscope()</a></code></li>
</ul>
</li>
</ul>
<p>A Trelliscope data frame can be refined by piping it through any of
these functions. First we will focus on the “writing and viewing”
functions.</p>
</div>
<div class="section level3">
<h3 id="writing-panels-and-viewing-the-display">Writing panels and viewing the display<a class="anchor" aria-label="anchor" href="#writing-panels-and-viewing-the-display"></a>
</h3>
<p>Let’s revisit the gapminder example. Here we put together all the
individual pieces we described earlier to get from the raw gapminder
data to a Trelliscope data frame in one code block.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">trell_df</span> <span class="op">&lt;-</span> <span class="op">(</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">gapminder</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">year</span>, <span class="va">lifeExp</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="../reference/facet_panels.html">facet_panels</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">country</span>, <span class="va">continent</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/nest_panels.html">nest_panels</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/as_trelliscope_df.html">as_trelliscope_df</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"gapminder life expectancy"</span>, path <span class="op">=</span> <span class="st">"lifeexp"</span><span class="op">)</span></span></code></pre></div>
<p>The Trelliscope viewer app displays pre-rendered panels, so they must
be written before you can view a display. This can be done with the
<code><a href="../reference/write_panels.html">write_panels()</a></code> function. This function provides arguments
that allow you to specify how you want the panels to be written
(e.g. image format, aspect ratio, etc.).</p>
<p>We can specify that we want our gapminder panels to render as svg
files with a 2:1 aspect ratio (specifed with
e.g. <code>width = 600</code> and <code>height = 300</code>).</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">trell_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/write_panels.html">write_panels</a></span><span class="op">(</span><span class="va">trell_df</span>, format <span class="op">=</span> <span class="st">"svg"</span>, width <span class="op">=</span> <span class="fl">600</span>, height <span class="op">=</span> <span class="fl">300</span><span class="op">)</span></span>
<span><span class="co">#&gt; Writing panels <span style="color: #00BB00;">■■■■■■■                         </span>  20% | ETA:  8s</span></span>
<span><span class="co">#&gt; Writing panels <span style="color: #00BB00;">■■■■■■■■■■■■■■■                 </span>  48% | ETA:  6s</span></span>
<span><span class="co">#&gt; Writing panels <span style="color: #00BB00;">■■■■■■■■■■■■■■■■■■■■■■■         </span>  72% | ETA:  3s</span></span>
<span><span class="co">#&gt; Writing panels <span style="color: #00BB00;">■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■ </span> 100% | ETA:  0s</span></span></code></pre></div>
<p>Note that we do not need to explicity call
<code><a href="../reference/write_panels.html">write_panels()</a></code> if we are happy with the defaults (500x500px
png). If Trelliscope notices that panels have not been written or that
panel contents have updated since the last time they were written, it
will write the panels automatically with the defaults. To force writing
panels you can add <code>force = TRUE</code> to
<code><a href="../reference/write_panels.html">write_panels()</a></code>.</p>
<!-- #### `write_panels()`

The optional chain function `write_panels()` can be used to have finer control over how panels get written to disk. It also can give the advantage of making panel writing a separate step so that it does not need to be repeated every time a display might be modified.

The main arguments are `width`, `height`, and `format`. The `width` and `height` are specified in pixels, and are mainly to provide information about the plot's aspect ratio and size of text and glyphs. The actual dimensions of the plot as shown in the viewer will vary (the aspect ratio remains fixed) depending on how many plots are shown at once.

The file format can be either `png` or `svg`. This is ignored if the plot column of the data frame is an htmlwidget such as a ggplotly plot.

disp <- disp |>
  write_panels(width = 800, height = 500, format = "svg")

Once the panels are written, a note is made in the `disp` object so that it knows it doesn't have to be done with writing out the display. -->
</div>
<div class="section level3">
<h3 id="adding-metadata-to-a-trelliscope-data-frame">Adding metadata to a Trelliscope data frame<a class="anchor" aria-label="anchor" href="#adding-metadata-to-a-trelliscope-data-frame"></a>
</h3>
<p>Before getting into the other pipe functions, we will address one of
Trelliscope’s most useful features; the ability to sort and filter your
visualizations on associated metadata. Most of the other pipe functions
help specify how this metadata is presented in the app.</p>
<p>Metadata can be any value related to a panel in the display. In the
case of our gapminder example, it could be computed metrics such as the
mean life expectancy, or it could be any other attribute about a country
such as the country’s capital city or even a link to its government
webpage.</p>
<p>Any column of atomic values in a Trelliscope data frame is
automatically considered as metadata. Therefore, to add new metadata
variables to the data, we can simply join or create any additional
columns to our data frame.</p>
<p>We will add on to our example from earlier by joining metadata to our
nested data frame from earlier that we can then use for sorting and
filtering in the Trelliscope viewing app.</p>
<p>Let’s remind ourselves of what is already in this data frame.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">trell_df</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Trelliscope data frame. Call show_info() for more information</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 123 × 5</span></span></span>
<span><span class="co">#&gt;    country     continent data              panel      `__PANEL_KEY__`   </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;nstd_pnl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> Afghanistan Asia      <span style="color: #949494;">&lt;tibble [12 × 8]&gt;</span> <span style="color: #949494;">&lt;gg&gt;</span>       Afghanistan_Asia  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> Albania     Europe    <span style="color: #949494;">&lt;tibble [12 × 8]&gt;</span> <span style="color: #949494;">&lt;gg&gt;</span>       Albania_Europe    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> Algeria     Africa    <span style="color: #949494;">&lt;tibble [12 × 8]&gt;</span> <span style="color: #949494;">&lt;gg&gt;</span>       Algeria_Africa    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> Angola      Africa    <span style="color: #949494;">&lt;tibble [12 × 8]&gt;</span> <span style="color: #949494;">&lt;gg&gt;</span>       Angola_Africa     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> Argentina   Americas  <span style="color: #949494;">&lt;tibble [12 × 8]&gt;</span> <span style="color: #949494;">&lt;gg&gt;</span>       Argentina_Americas</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> Australia   Oceania   <span style="color: #949494;">&lt;tibble [12 × 8]&gt;</span> <span style="color: #949494;">&lt;gg&gt;</span>       Australia_Oceania </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> Austria     Europe    <span style="color: #949494;">&lt;tibble [12 × 8]&gt;</span> <span style="color: #949494;">&lt;gg&gt;</span>       Austria_Europe    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> Bahrain     Asia      <span style="color: #949494;">&lt;tibble [12 × 8]&gt;</span> <span style="color: #949494;">&lt;gg&gt;</span>       Bahrain_Asia      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> Bangladesh  Asia      <span style="color: #949494;">&lt;tibble [12 × 8]&gt;</span> <span style="color: #949494;">&lt;gg&gt;</span>       Bangladesh_Asia   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> Belgium     Europe    <span style="color: #949494;">&lt;tibble [12 × 8]&gt;</span> <span style="color: #949494;">&lt;gg&gt;</span>       Belgium_Europe    </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 113 more rows</span></span></span></code></pre></div>
<p>Here, the only metadata variables are <code>country</code> and
<code>continent</code> (<code>data</code> is not because it is not
scalar). Suppose we want to add more variables such as some summary
statistics about life expectancy and GDP. One way to do this would be to
operate on the <code>data</code> column of <code>trell_df</code>,
computing the summaries from each nested data frame. A more natural way
to do this is to create a separate data frame of summaries computed
directly on the <code>gapminder</code> dataset and join them with our
Trelliscope data frame.</p>
<p>Here, we use <code>dplyr</code> to compute the summaries. If you have
experience with Tidyverse packages such as dplyr and tidyr, the examples
below will be straightforward. If not, a great resource for this can be
found in <a href="https://r4ds.had.co.nz/index.html" class="external-link">“R for Data
Science”</a>, particularly <a href="https://r4ds.had.co.nz/many-models.html" class="external-link">this chapter</a> which
mimics many of the ideas here of nesting and list columns with the same
data set. Of course, you can use any other approach to computing the
summaries as well.</p>
<!-- Note that although the tidyverse provides many helpful functions, it does not matter what package or approach you use as long as you can get your data into the form of a data frame with one row per visualization and a visualization column. It's worth noting that the visualization column does not have to be a ggplot. It can be static images, plotly visualizations, or any other html based visualization. -->
<p>Since each row of <code>trell_df</code> corresponds to a single
country/continent, we need our summaries to be computed for each
country/continent. Here we create a data frame of metadata with some
summary statistics and construct a Wikipedia link for each country.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">meta_df</span> <span class="op">&lt;-</span> <span class="va">gapminder</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">country</span>, <span class="va">continent</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    mean_lifeExp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">lifeExp</span><span class="op">)</span>,</span>
<span>    min_lifeExp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">lifeExp</span><span class="op">)</span>,</span>
<span>    mean_gdp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">gdpPercap</span><span class="op">)</span>,</span>
<span>    .groups <span class="op">=</span> <span class="st">"drop"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    wiki_link <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"https://en.wikipedia.org/wiki/"</span>, <span class="va">country</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">meta_df</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 123 × 6</span></span></span>
<span><span class="co">#&gt;    country     continent mean_lifeExp min_lifeExp mean_gdp wiki_link            </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> Afghanistan Asia              37.5        28.8     803. https://en.wikipedia…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> Albania     Europe            68.4        55.2    <span style="text-decoration: underline;">3</span>255. https://en.wikipedia…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> Algeria     Africa            59.0        43.1    <span style="text-decoration: underline;">4</span>426. https://en.wikipedia…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> Angola      Africa            37.9        30.0    <span style="text-decoration: underline;">3</span>607. https://en.wikipedia…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> Argentina   Americas          69.1        62.5    <span style="text-decoration: underline;">8</span>956. https://en.wikipedia…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> Australia   Oceania           74.7        69.1   <span style="text-decoration: underline;">19</span>981. https://en.wikipedia…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> Austria     Europe            73.1        66.8   <span style="text-decoration: underline;">20</span>412. https://en.wikipedia…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> Bahrain     Asia              65.6        50.9   <span style="text-decoration: underline;">18</span>078. https://en.wikipedia…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> Bangladesh  Asia              49.8        37.5     818. https://en.wikipedia…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> Belgium     Europe            73.6        68     <span style="text-decoration: underline;">19</span>901. https://en.wikipedia…</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 113 more rows</span></span></span></code></pre></div>
<p>With our metadata frame created we can now join it to the original
nested data frame with our panels stored in it to create a complete data
frame.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">trell_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">trell_df</span>, <span class="va">meta_df</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"country"</span>, <span class="st">"continent"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">trell_df</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Trelliscope data frame. Call show_info() for more information</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 123 × 9</span></span></span>
<span><span class="co">#&gt;    country     continent data     panel `__PANEL_KEY__` mean_lifeExp min_lifeExp</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;nst&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> Afghanistan Asia      <span style="color: #949494;">&lt;tibble&gt;</span> <span style="color: #949494;">&lt;gg&gt;</span>  Afghanistan_As…         37.5        28.8</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> Albania     Europe    <span style="color: #949494;">&lt;tibble&gt;</span> <span style="color: #949494;">&lt;gg&gt;</span>  Albania_Europe          68.4        55.2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> Algeria     Africa    <span style="color: #949494;">&lt;tibble&gt;</span> <span style="color: #949494;">&lt;gg&gt;</span>  Algeria_Africa          59.0        43.1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> Angola      Africa    <span style="color: #949494;">&lt;tibble&gt;</span> <span style="color: #949494;">&lt;gg&gt;</span>  Angola_Africa           37.9        30.0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> Argentina   Americas  <span style="color: #949494;">&lt;tibble&gt;</span> <span style="color: #949494;">&lt;gg&gt;</span>  Argentina_Amer…         69.1        62.5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> Australia   Oceania   <span style="color: #949494;">&lt;tibble&gt;</span> <span style="color: #949494;">&lt;gg&gt;</span>  Australia_Ocea…         74.7        69.1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> Austria     Europe    <span style="color: #949494;">&lt;tibble&gt;</span> <span style="color: #949494;">&lt;gg&gt;</span>  Austria_Europe          73.1        66.8</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> Bahrain     Asia      <span style="color: #949494;">&lt;tibble&gt;</span> <span style="color: #949494;">&lt;gg&gt;</span>  Bahrain_Asia            65.6        50.9</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> Bangladesh  Asia      <span style="color: #949494;">&lt;tibble&gt;</span> <span style="color: #949494;">&lt;gg&gt;</span>  Bangladesh_Asia         49.8        37.5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> Belgium     Europe    <span style="color: #949494;">&lt;tibble&gt;</span> <span style="color: #949494;">&lt;gg&gt;</span>  Belgium_Europe          73.6        68  </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 113 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 2 more variables: mean_gdp &lt;dbl&gt;, wiki_link &lt;chr&gt;</span></span></span></code></pre></div>
<p>If you view this display with <code><a href="../reference/view_trelliscope.html">view_trelliscope()</a></code>, you
will see that these new variables are available for sorting and
filtering. There are different metadata variable types that we will
discuss below. If not explicitly specified, Trelliscope will try to
infer these. For example, you may notice in the Trelliscope app that the
<code>wiki_link</code> metadata variable is auto-detected to be a URL
and is available as such when shown as a panel label.</p>
</div>
<div class="section level3">
<h3 id="defining-metadata-variables">Defining metadata variables<a class="anchor" aria-label="anchor" href="#defining-metadata-variables"></a>
</h3>
<p>Each metadata variable can have additional attributes specified about
it that enhance the user’s experience when viewing the display. The main
attribute is the metadata variable label. Without supplying a label,
variables will appear in the viewer by their variable names
(e.g. “mean_gdp” vs. a label you might prefer to provide for more
clarity to the user, such as “Mean of yearly GDP per capita (US$,
inflation-adjusted)”).</p>
<p>Additionally, we can specify the variable type, specify tags
(e.g. “demographics”, “geography”, etc.) that can make variables easier
to navigate in the viewer when there are many of them, and other
type-specific parameters.</p>
<p>Each metadata variable can be specified by using a helper function
that specifies its type. Each of these has the arguments
<code>varname</code>, <code>label</code>, and <code>tags</code> (denoted
below with <code>...</code>) and any additional arguments which are
either self-explanatory or can be further studied by looking at the
function help files.</p>
<ul>
<li>
<code>meta_string(...)</code>: indicates the variable is a
string</li>
<li>
<code>meta_factor(..., levels)</code>: indicates the variable is a
factor - the difference between this and a string is that the provided
<code>levels</code> are used to determine the sorting order, etc. as
opposed to alphabetically with strings</li>
<li>
<code>meta_number(..., digits, locale)</code>: indicates a numeric
variable</li>
<li>
<code>meta_currency(..., code)</code>: indicates a currency variable
- essentially the same as a number but will be displayed differently in
the app</li>
<li>
<code>meta_date(...)</code>: indicates a date variable</li>
<li>
<code>meta_datetime(...)</code>: indicates a datetime variable</li>
<li>
<code>meta_href(...)</code>: indicates a variable that contains a
hyperlink to another web source - it will be rendered as a
hyperlink</li>
<li>
<code>meta_geo(..., latvar, longvar)</code>: indicates geographic
coordinates (currently not supported)</li>
<li>
<code>meta_graph(..., idvarname, direction)</code>: indicates
network graph relationships between variables (currently not
supported)</li>
</ul>
<p>We can provide metadata variable specifications by calling
<code><a href="../reference/add_meta_defs.html">add_meta_defs()</a></code> on our trelliscope data frame. This
function takes as arguments any number of <code>meta_*()</code> function
calls. For example, let’s build up our object to include some of these
metadata variable specifications:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">trell_df</span> <span class="op">&lt;-</span> <span class="va">trell_df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/add_meta_defs.html">add_meta_defs</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/meta_number.html">meta_number</a></span><span class="op">(</span><span class="st">"mean_gdp"</span>,</span>
<span>      label <span class="op">=</span> <span class="st">"Mean of annual GDP per capita (US$, inflation-adjusted)"</span>,</span>
<span>      digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/meta_href.html">meta_href</a></span><span class="op">(</span><span class="st">"wiki_link"</span>, label <span class="op">=</span> <span class="st">"Wikipedia country page"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Inferred that variable 'mean_gdp' should be shown on log</span></span>
<span><span class="co">#&gt; scale.</span></span>
<span></span>
<span><span class="fu"><a href="../reference/show_info.html">show_info</a></span><span class="op">(</span><span class="va">trell_df</span><span class="op">)</span></span>
<span><span class="co">#&gt; A trelliscope display</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> <span style="font-weight: bold;">Name</span>: <span style="color: #0000BB;">"gapminder life expectancy"</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> <span style="font-weight: bold;">Description</span>: <span style="color: #0000BB;">"gapminder life expectancy"</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> <span style="font-weight: bold;">Tags</span>: <span style="font-style: italic;">none</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> <span style="font-weight: bold;">Key columns</span>: <span style="color: #0000BB;">"country"</span> and <span style="color: #0000BB;">"continent"</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> <span style="font-weight: bold;">Path</span>: <span style="color: #9E9E9E;">"lifeexp"</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> <span style="font-weight: bold;">Number of panels</span>: <span style="color: #0000BB;">123</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> <span style="font-weight: bold;">Panels written</span>: <span style="font-style: italic;">yes</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> Defined metadata variables:</span></span>
<span><span class="co">#&gt; <span style="color: #9E9E9E;">    ─────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; <span style="color: #9E9E9E;">    name      type   label                      tags </span></span></span>
<span><span class="co">#&gt; <span style="color: #9E9E9E;">    ─────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; <span style="color: #9E9E9E;">    </span><span style="color: #BCBCBC;">1</span><span style="color: #9E9E9E;"> mean_gdp  number Mean of annual GDP per ca… []   </span></span></span>
<span><span class="co">#&gt; <span style="color: #9E9E9E;">    </span><span style="color: #BCBCBC;">2</span><span style="color: #9E9E9E;"> wiki_link href   Wikipedia country page     []   </span></span></span>
<span><span class="co">#&gt; <span style="color: #9E9E9E;">    ─────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> Metadata variables that will be inferred:</span></span>
<span><span class="co">#&gt; <span style="color: #9E9E9E;">    ───────────────────────────────────</span></span></span>
<span><span class="co">#&gt; <span style="color: #9E9E9E;">    name         `inferred type` label </span></span></span>
<span><span class="co">#&gt; <span style="color: #9E9E9E;">    ───────────────────────────────────</span></span></span>
<span><span class="co">#&gt; <span style="color: #9E9E9E;">    </span><span style="color: #BCBCBC;">1</span><span style="color: #9E9E9E;"> country      string          [none]</span></span></span>
<span><span class="co">#&gt; <span style="color: #9E9E9E;">    </span><span style="color: #BCBCBC;">2</span><span style="color: #9E9E9E;"> continent    factor          [none]</span></span></span>
<span><span class="co">#&gt; <span style="color: #9E9E9E;">    </span><span style="color: #BCBCBC;">3</span><span style="color: #9E9E9E;"> mean_lifeExp number          [none]</span></span></span>
<span><span class="co">#&gt; <span style="color: #9E9E9E;">    </span><span style="color: #BCBCBC;">4</span><span style="color: #9E9E9E;"> min_lifeExp  number          [none]</span></span></span>
<span><span class="co">#&gt; <span style="color: #9E9E9E;">    ───────────────────────────────────</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> Variables that will be ignored as metadata: <span style="color: #0000BB;">"data"</span> and <span style="color: #0000BB;">"panel"</span></span></span></code></pre></div>
<p>If metadata variable definitions are not provided (such as here where
we don’t provide explicit definitions for <code>country</code>,
<code>continent</code>, <code>min_lifeExp</code>, and
<code>mean_lifeExp</code>), they are inferred at the time the display is
written. The inference usually works pretty well but it cannot infer
labels and is not able to detect things like currencies.</p>
<div class="section level4">
<h4 id="add_meta_labels">
<code>add_meta_labels()</code><a class="anchor" aria-label="anchor" href="#add_meta_labels"></a>
</h4>
<p>Often the metadata inference works well enough that we might just
want to provide labels for our metadata variables and skip the more
formal metadata variable definition. We can do this with
<code><a href="../reference/add_meta_labels.html">add_meta_labels()</a></code>. This function simply takes a named set
of parameters as input, with the names indicating the variable name and
the values indicating the labels. For example:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">trell_df</span> <span class="op">&lt;-</span> <span class="va">trell_df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/add_meta_labels.html">add_meta_labels</a></span><span class="op">(</span></span>
<span>    mean_lifeExp <span class="op">=</span> <span class="st">"Mean of annual life expectancies"</span>,</span>
<span>    min_lifeExp <span class="op">=</span> <span class="st">"Lowest observed annual life expectancy"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/show_info.html">show_info</a></span><span class="op">(</span><span class="va">trell_df</span><span class="op">)</span></span>
<span><span class="co">#&gt; A trelliscope display</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> <span style="font-weight: bold;">Name</span>: <span style="color: #0000BB;">"gapminder life expectancy"</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> <span style="font-weight: bold;">Description</span>: <span style="color: #0000BB;">"gapminder life expectancy"</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> <span style="font-weight: bold;">Tags</span>: <span style="font-style: italic;">none</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> <span style="font-weight: bold;">Key columns</span>: <span style="color: #0000BB;">"country"</span> and <span style="color: #0000BB;">"continent"</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> <span style="font-weight: bold;">Path</span>: <span style="color: #9E9E9E;">"lifeexp"</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> <span style="font-weight: bold;">Number of panels</span>: <span style="color: #0000BB;">123</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> <span style="font-weight: bold;">Panels written</span>: <span style="font-style: italic;">yes</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> Defined metadata variables:</span></span>
<span><span class="co">#&gt; <span style="color: #9E9E9E;">    ─────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; <span style="color: #9E9E9E;">    name      type   label                      tags </span></span></span>
<span><span class="co">#&gt; <span style="color: #9E9E9E;">    ─────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; <span style="color: #9E9E9E;">    </span><span style="color: #BCBCBC;">1</span><span style="color: #9E9E9E;"> mean_gdp  number Mean of annual GDP per ca… []   </span></span></span>
<span><span class="co">#&gt; <span style="color: #9E9E9E;">    </span><span style="color: #BCBCBC;">2</span><span style="color: #9E9E9E;"> wiki_link href   Wikipedia country page     []   </span></span></span>
<span><span class="co">#&gt; <span style="color: #9E9E9E;">    ─────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> Metadata variables that will be inferred:</span></span>
<span><span class="co">#&gt; <span style="color: #9E9E9E;">    ───────────────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; <span style="color: #9E9E9E;">    name         `inferred type` label                                 </span></span></span>
<span><span class="co">#&gt; <span style="color: #9E9E9E;">    ───────────────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; <span style="color: #9E9E9E;">    </span><span style="color: #BCBCBC;">1</span><span style="color: #9E9E9E;"> country      string          [none]                                </span></span></span>
<span><span class="co">#&gt; <span style="color: #9E9E9E;">    </span><span style="color: #BCBCBC;">2</span><span style="color: #9E9E9E;"> continent    factor          [none]                                </span></span></span>
<span><span class="co">#&gt; <span style="color: #9E9E9E;">    </span><span style="color: #BCBCBC;">3</span><span style="color: #9E9E9E;"> mean_lifeExp number          Mean of annual life expectancies      </span></span></span>
<span><span class="co">#&gt; <span style="color: #9E9E9E;">    </span><span style="color: #BCBCBC;">4</span><span style="color: #9E9E9E;"> min_lifeExp  number          Lowest observed annual life expectancy</span></span></span>
<span><span class="co">#&gt; <span style="color: #9E9E9E;">    ───────────────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> Variables that will be ignored as metadata: <span style="color: #0000BB;">"data"</span> and <span style="color: #0000BB;">"panel"</span></span></span></code></pre></div>
<p>We still haven’t specified labels for <code>country</code> and
<code>continent</code>. If labels are not provided, they will be set to
the variable name. In the case of these two variables, the variable name
is clear enough to not need to specify the labels.</p>
</div>
</div>
<div class="section level3">
<h3 id="setting-the-default-state-of-the-app">Setting the default state of the app<a class="anchor" aria-label="anchor" href="#setting-the-default-state-of-the-app"></a>
</h3>
<p>Trelliscope apps by default display all panels in the order as they
appear in the data frame. Often it makes sense to start the user off at
a specific point in the app, such as pre-defining a sorting or filtering
state, or defining which panel labels you want the user to see
initially.</p>
<div class="section level4">
<h4 id="set_default_labels">
<code>set_default_labels()</code><a class="anchor" aria-label="anchor" href="#set_default_labels"></a>
</h4>
<p>By default, the “key columns” will be shown as labels. If we’d like
to change what labels are shown when the display is opened, we can use
<code><a href="../reference/set_default_labels.html">set_default_labels()</a></code>, e.g.:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">trell_df</span> <span class="op">&lt;-</span> <span class="va">trell_df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/set_default_labels.html">set_default_labels</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"country"</span>, <span class="st">"continent"</span>, <span class="st">"wiki_link"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="set_default_layout">
<code>set_default_layout()</code><a class="anchor" aria-label="anchor" href="#set_default_layout"></a>
</h4>
<p>We can also set the default panel layout, for example that we wish to
see 5 columns of panels on the initial view of the app (number of rows
is computed based on the size of the user’s browser window and the
aspect ratio of the panels).</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">trell_df</span> <span class="op">&lt;-</span> <span class="va">trell_df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/set_default_layout.html">set_default_layout</a></span><span class="op">(</span>ncol <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="set_default_sort">
<code>set_default_sort()</code><a class="anchor" aria-label="anchor" href="#set_default_sort"></a>
</h4>
<p>We can set the default sort order with
<code><a href="../reference/set_default_sort.html">set_default_sort()</a></code>. For this, we provide a vector of
variable names and a vector of “asc” or “desc” values inidicatingm an
ascending or descending sort order.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">trell_df</span> <span class="op">&lt;-</span> <span class="va">trell_df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/set_default_sort.html">set_default_sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"continent"</span>, <span class="st">"mean_lifeExp"</span><span class="op">)</span>, dir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"asc"</span>, <span class="st">"desc"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="set_default_filters">
<code>set_default_filters()</code><a class="anchor" aria-label="anchor" href="#set_default_filters"></a>
</h4>
<p>We can set the default filter state with
<code><a href="../reference/set_default_filters.html">set_default_filters()</a></code>. Currently there are two different
kinds of filters:</p>
<ul>
<li>
<code>filter_range(varname, min = ..., max = ...)</code>: works with
numeric, date, or datetime variables</li>
<li>
<code>filter_string(varname, values = ...)</code>: works with factor
or string variables</li>
</ul>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">trell_df</span> <span class="op">&lt;-</span> <span class="va">trell_df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/set_default_filters.html">set_default_filters</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/filter_string.html">filter_string</a></span><span class="op">(</span><span class="st">"continent"</span>, values <span class="op">=</span> <span class="st">"Africa"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/filter_range.html">filter_range</a></span><span class="op">(</span><span class="st">"mean_lifeExp"</span>, max <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>More types of filters are planned.</p>
</div>
</div>
<div class="section level3">
<h3 id="defining-views">Defining “views”<a class="anchor" aria-label="anchor" href="#defining-views"></a>
</h3>
<p>Views are predefined sets of state that are made available in the
viewer to help the user conveniently get to regions of the display that
are interesting in different ways. You can add a view chaining the
display through the <code><a href="../reference/add_view.html">add_view()</a></code> function.</p>
<p><code><a href="../reference/add_view.html">add_view()</a></code> takes a <code>name</code> as its first
argument, and then any number of state specifications. The functions
available to set the state are the following:</p>
<ul>
<li><code><a href="../reference/state_layout.html">state_layout()</a></code></li>
<li><code><a href="../reference/state_labels.html">state_labels()</a></code></li>
<li><code><a href="../reference/state_sort.html">state_sort()</a></code></li>
<li><code><a href="../reference/filter_string.html">filter_string()</a></code></li>
<li><code><a href="../reference/filter_range.html">filter_range()</a></code></li>
</ul>
<p>The <code>state_*()</code> functions have the same parameters as and
behave similarly to their <code>set_*()</code> counterparts except that
unlike those, these do not receive a Trelliscope data frame and return a
Trelliscope data frame, but instead just specify a state. The
<code>filter_*()</code> functions we have seen already.</p>
<p>For example, suppose we wish to add a view that only shows countries
with minimum life expectancy greater than or equal to 60, sorted from
highest to lowest minimum life expectancy:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">trell_df</span> <span class="op">&lt;-</span> <span class="va">trell_df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/add_view.html">add_view</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">"Countries with high life expectancy (min &gt;= 60)"</span>,</span>
<span>    <span class="fu"><a href="../reference/filter_range.html">filter_range</a></span><span class="op">(</span><span class="st">"min_lifeExp"</span>, min <span class="op">=</span> <span class="fl">60</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/state_sort.html">state_sort</a></span><span class="op">(</span><span class="st">"min_lifeExp"</span>, dir <span class="op">=</span> <span class="st">"desc"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>You can add as many views as you would like by chaining more calls to
<code><a href="../reference/add_view.html">add_view()</a></code>.</p>
</div>
<div class="section level3">
<h3 id="specifying-user-inputs">Specifying user inputs<a class="anchor" aria-label="anchor" href="#specifying-user-inputs"></a>
</h3>
<p>You can add user inputs that are attached to each panel of the
display using the <code><a href="../reference/add_inputs.html">add_inputs()</a></code> function. This function
takes any number of arguments created by any of the following
functions:</p>
<ul>
<li><code>input_radio(name, label, options)</code></li>
<li><code>input_text(name, label, width, height)</code></li>
</ul>
<p>The following additional input types exist but are not yet supported
in the app.</p>
<ul>
<li><code>input_checkbox(name, label, options)</code></li>
<li><code>input_select(name, label, options)</code></li>
<li><code>input_multiselect(name, label, options)</code></li>
<li><code>input_number(name, label)</code></li>
</ul>
<p>These specify different input types.</p>
<p>For example, if we want a free text input for comments as well as
yes/no question asking if the data looks correct for the panel, we can
do the following.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">trell_df</span> <span class="op">&lt;-</span> <span class="va">trell_df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/add_inputs.html">add_inputs</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/input_text.html">input_text</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"comments"</span>, label <span class="op">=</span> <span class="st">"Comments about this panel"</span>,</span>
<span>      width <span class="op">=</span> <span class="fl">100</span>, height <span class="op">=</span> <span class="fl">6</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/input_radio.html">input_radio</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"looks_correct"</span>,</span>
<span>      label <span class="op">=</span> <span class="st">"Does the data look correct?"</span>, options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"no"</span>, <span class="st">"yes"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    email <span class="op">=</span> <span class="st">"johndoe123@fakemail.net"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>The final argument, <code>email</code>, is currently required and
will provide the user with a way to send their inputs back to you. Since
the Trelliscope app is not backed by a server, persistent storage of
user inputs is currently not supported, and you will need to capture
these inputs from the user directly.</p>
<p>Let’s see how all of these operations are reflected in our
Trelliscope data frame:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/show_info.html">show_info</a></span><span class="op">(</span><span class="va">trell_df</span><span class="op">)</span></span>
<span><span class="co">#&gt; A trelliscope display</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> <span style="font-weight: bold;">Name</span>: <span style="color: #0000BB;">"gapminder life expectancy"</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> <span style="font-weight: bold;">Description</span>: <span style="color: #0000BB;">"gapminder life expectancy"</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> <span style="font-weight: bold;">Tags</span>: <span style="font-style: italic;">none</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> <span style="font-weight: bold;">Key columns</span>: <span style="color: #0000BB;">"country"</span> and <span style="color: #0000BB;">"continent"</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> <span style="font-weight: bold;">Path</span>: <span style="color: #9E9E9E;">"lifeexp"</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> <span style="font-weight: bold;">Number of panels</span>: <span style="color: #0000BB;">123</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> <span style="font-weight: bold;">Panels written</span>: <span style="font-style: italic;">yes</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> Defined metadata variables:</span></span>
<span><span class="co">#&gt; <span style="color: #9E9E9E;">    ─────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; <span style="color: #9E9E9E;">    name      type   label                      tags </span></span></span>
<span><span class="co">#&gt; <span style="color: #9E9E9E;">    ─────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; <span style="color: #9E9E9E;">    </span><span style="color: #BCBCBC;">1</span><span style="color: #9E9E9E;"> mean_gdp  number Mean of annual GDP per ca… []   </span></span></span>
<span><span class="co">#&gt; <span style="color: #9E9E9E;">    </span><span style="color: #BCBCBC;">2</span><span style="color: #9E9E9E;"> wiki_link href   Wikipedia country page     []   </span></span></span>
<span><span class="co">#&gt; <span style="color: #9E9E9E;">    ─────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> Metadata variables that will be inferred:</span></span>
<span><span class="co">#&gt; <span style="color: #9E9E9E;">    ───────────────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; <span style="color: #9E9E9E;">    name         `inferred type` label                                 </span></span></span>
<span><span class="co">#&gt; <span style="color: #9E9E9E;">    ───────────────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; <span style="color: #9E9E9E;">    </span><span style="color: #BCBCBC;">1</span><span style="color: #9E9E9E;"> country      string          [none]                                </span></span></span>
<span><span class="co">#&gt; <span style="color: #9E9E9E;">    </span><span style="color: #BCBCBC;">2</span><span style="color: #9E9E9E;"> continent    factor          [none]                                </span></span></span>
<span><span class="co">#&gt; <span style="color: #9E9E9E;">    </span><span style="color: #BCBCBC;">3</span><span style="color: #9E9E9E;"> mean_lifeExp number          Mean of annual life expectancies      </span></span></span>
<span><span class="co">#&gt; <span style="color: #9E9E9E;">    </span><span style="color: #BCBCBC;">4</span><span style="color: #9E9E9E;"> min_lifeExp  number          Lowest observed annual life expectancy</span></span></span>
<span><span class="co">#&gt; <span style="color: #9E9E9E;">    ───────────────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> Variables that will be ignored as metadata: <span style="color: #0000BB;">"data"</span> and <span style="color: #0000BB;">"panel"</span></span></span></code></pre></div>
<div class="section level4">
<h4 id="output">Output<a class="anchor" aria-label="anchor" href="#output"></a>
</h4>
<p>Now that we have built up our Trelliscope data frame, we can write it
out as specified before with <code><a href="../reference/write_trelliscope.html">write_trelliscope()</a></code>.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">trell_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/write_trelliscope.html">write_trelliscope</a></span><span class="op">(</span><span class="va">trell_df</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Meta definitions inferred for variables <span style="color: #0000BB;">"country"</span>, <span style="color: #0000BB;">"continent"</span>,</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">"mean_lifeExp"</span>, and <span style="color: #0000BB;">"min_lifeExp"</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> No default <span style="color: #0000BB;">"layout"</span> state supplied for view 'Countries with high life</span></span>
<span><span class="co">#&gt;   expectancy (min &gt;= 60)'. <span style="font-style: italic;">Using ncol=3.</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> No default <span style="color: #0000BB;">"labels"</span> state supplied for view 'Countries with high life</span></span>
<span><span class="co">#&gt;   expectancy (min &gt;= 60)'. <span style="font-style: italic;">Using country, continent.</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Trelliscope written to lifeexp/index.html Open this file or call</span></span>
<span><span class="co">#&gt;   view_trelliscope() to view.</span></span></code></pre></div>
<p>This writes the panels if they haven’t been written yet and then
writes out a JSON representation of all of the other specifications we
have made for the app to consume.</p>
<p>Here is the final output.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/view_trelliscope.html">view_trelliscope</a></span><span class="op">(</span><span class="va">trell_df</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://ryanhafen.com" class="external-link">Ryan Hafen</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
